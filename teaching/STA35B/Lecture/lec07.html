<!DOCTYPE html>
<html lang="en"><head>
<script src="lec07_files/libs/clipboard/clipboard.min.js"></script>
<script src="lec07_files/libs/quarto-html/tabby.min.js"></script>
<script src="lec07_files/libs/quarto-html/popper.min.js"></script>
<script src="lec07_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="lec07_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lec07_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="lec07_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="lec07_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="Akira Horiguchi">
  <title>07: Dates and times</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="lec07_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="lec07_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="lec07_files/libs/revealjs/dist/theme/quarto.css">
  <link href="lec07_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="lec07_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="lec07_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="lec07_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">07: Dates and times</h1>
  <p class="subtitle">STA35B: Statistical Data Science 2</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Akira Horiguchi 
</div>
</div>
</div>

</section><section id="TOC">
<nav role="doc-toc"> 
<h2 id="toc-title">Table of contents</h2>
<ul>
<li><a href="#/dates-and-times" id="/toc-dates-and-times">Dates and times</a></li>
<li><a href="#/time-spans" id="/toc-time-spans">Time spans</a></li>
<li><a href="#/putting-it-all-together" id="/toc-putting-it-all-together">Putting it all together</a></li>
</ul>
</nav>
</section>
<section class="slide level2">

<p>Material from <a href="https://r4ds.hadley.nz/datetimes.html">Chapter 17 of R4DS2</a></p>
</section>
<section>
<section id="dates-and-times" class="title-slide slide level1 center">
<h1>Dates and times</h1>

</section>
<section id="dates-and-times-complications" class="slide level2">
<h2>Dates and times: complications</h2>
<p>Many things complicate working with dates and times</p>
<ul>
<li><p>Not all years have 365 days</p>
<blockquote>
<p>A year is a leap year if it’s divisible by 4, unless it’s also divisible by 100, except if it’s also divisible by 400. In other words, in every set of 400 years, there’s 97 leap years.</p>
</blockquote></li>
</ul>
<!-- ```{} -->
<!-- A year is a leap year if it’s divisible by 4,  -->
<!-- unless it’s also divisible by 100,  -->
<!-- except if it’s also divisible by 400.  -->
<!-- In other words, in every set of 400 years, there’s 97 leap years. -->
<!-- ``` -->
<ul>
<li>Not every day in every location has 24 hours a day
<ul>
<li>Daylight savings time implies one day has 23, another has 24</li>
</ul></li>
<li>Time zones are difficult!</li>
<li>We will be using <strong>lubridate</strong> package (part of <em>latest</em> tidyverse), and nycflights13.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href=""></a><span class="fu">library</span>(nycflights13)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-dates-and-times" class="slide level2">
<h2>Creating dates and times</h2>
<div class="columns">
<div class="column" style="width:61%;">
<p>Three types of date/time data:</p>
<ul>
<li>A <strong>date</strong>. Tibbles print this as <code>&lt;date&gt;</code></li>
<li>A <strong>time</strong> within a day. Tibbles print this as <code>&lt;time&gt;</code></li>
<li>A <strong>date-time</strong> is a date plus a time. Tibbles print this as <code>&lt;dttm&gt;</code>
<ul>
<li>It uniquely identifies an instant in time (typically to the nearest second).</li>
</ul>
<!-- * Base R calls these POSIXct. --></li>
</ul>
<p>We will focus on dates and date-times as R doesn’t have a native class for storing times. If you need one, you can use the <strong>hms</strong> package.</p>
<ul>
<li>Use the simplest possible data type that works for your needs (e.g., use a date instead of a date-time, if you can).</li>
</ul>
</div><div class="column" style="width:39%;">
<p>Get current date or date-time:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a><span class="fu">today</span>()  <span class="co"># get current date</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-04-11"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a><span class="fu">now</span>()  <span class="co"># get current date-time</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-04-11 17:43:44 PDT"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a><span class="fu">tibble</span>(<span class="at">y=</span><span class="fu">today</span>(), <span class="at">x=</span><span class="fu">now</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  y          x                  
  &lt;date&gt;     &lt;dttm&gt;             
1 2025-04-11 2025-04-11 17:43:44</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href=""></a><span class="fu">class</span>(<span class="fu">today</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Date"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href=""></a><span class="fu">class</span>(<span class="fu">now</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "POSIXct" "POSIXt" </code></pre>
</div>
</div>
</div></div>
</section>
<section id="extracting-dates-and-times-from-strings" class="slide level2">
<h2>Extracting dates and times from strings</h2>
<div class="columns">
<div class="column" style="width:46%;">
<p>To create <strong>dates</strong>, convert a string using functions whose names are three letter combos of “y”, “m”, “d”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a><span class="fu">ymd</span>(<span class="st">"2017-01-31"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017-01-31"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href=""></a><span class="fu">mdy</span>(<span class="st">"January 31st, 2017"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017-01-31"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href=""></a><span class="fu">mdy</span>(<span class="st">"January 31, 2017"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017-01-31"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href=""></a><span class="fu">dmy</span>(<span class="st">"31-Jan-2017"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017-01-31"</code></pre>
</div>
</div>
</div><div class="column" style="width:54%;">
<p>To create <strong>date-times</strong>, add an underscore <code>_</code> and then one or more of “h”, “m”, “s”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href=""></a>(<span class="fu">ymd_hms</span>(<span class="st">"2017-01-31 20:11:59"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017-01-31 20:11:59 UTC"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href=""></a><span class="fu">mdy_hm</span>(<span class="st">"01/31/2017 08:01"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017-01-31 08:01:00 UTC"</code></pre>
</div>
</div>
<ul>
<li>Times are assumed to be UTC time zone; can change by using <code>tz=</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href=""></a><span class="fu">mdy_hm</span>(<span class="st">"01/31/2017 08:01"</span>, <span class="at">tz =</span> <span class="st">"EST"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2017-01-31 08:01:00 EST"</code></pre>
</div>
</div>
</div></div>
</section>
<section id="creating-date-times-from-dplyr-parts" class="slide level2">
<h2>Creating date-times from dplyr parts</h2>
<p>Remember how flights stored some of the date information:</p>
<div class="cell" data-output.lines="5">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href=""></a>flights <span class="sc">|&gt;</span> <span class="fu">select</span>(year, month, day, hour, minute)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 5
    year month   day  hour minute
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1  2013     1     1     5     15
 2  2013     1     1     5     29
...</code></pre>
</div>
</div>
<ul>
<li>To create date/time from this, can use <code>make_date()</code> or <code>make_datetime()</code>:</li>
</ul>
<div class="cell" data-output.lines="5">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href=""></a>flights <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">departure =</span> <span class="fu">make_datetime</span>(year, month, day, hour, minute), <span class="at">.keep=</span><span class="st">"used"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 6
    year month   day  hour minute departure          
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dttm&gt;             
 1  2013     1     1     5     15 2013-01-01 05:15:00
 2  2013     1     1     5     29 2013-01-01 05:29:00
...</code></pre>
</div>
</div>
</section>
<section id="creating-date-times-from-dplyr-parts-1" class="slide level2">
<h2>Creating date-times from dplyr parts</h2>
<ul>
<li>We’ll now do a similar computation for the four time columns in flights</li>
<li>We’ll do so using a <strong>function</strong> - we haven’t seen this yet, but we will see it in a couple weeks</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href=""></a>make_datetime_100 <span class="ot">&lt;-</span> <span class="cf">function</span>(year, month, day, time) {</span>
<span id="cb30-2"><a href=""></a>  <span class="co"># recall: time is an integer, use modular arithmetic to convert </span></span>
<span id="cb30-3"><a href=""></a>  hr <span class="ot">&lt;-</span> time <span class="sc">%/%</span> <span class="dv">100</span>  <span class="co"># get first digit of `time`</span></span>
<span id="cb30-4"><a href=""></a>  mnt <span class="ot">&lt;-</span> time <span class="sc">%%</span> <span class="dv">100</span>  <span class="co"># get last two digits of `time`</span></span>
<span id="cb30-5"><a href=""></a>  <span class="fu">make_datetime</span>(year, month, day, hr, mnt)</span>
<span id="cb30-6"><a href=""></a>} </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-date-times-from-dplyr-parts-2" class="slide level2">
<h2>Creating date-times from dplyr parts</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" data-code-line-numbers="3-8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href=""></a>flights_dt <span class="ot">&lt;-</span> flights <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href=""></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dep_time), <span class="sc">!</span><span class="fu">is.na</span>(arr_time)) <span class="sc">|&gt;</span> </span>
<span id="cb31-3"><a href=""></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-4"><a href=""></a>    <span class="at">dep_time =</span> <span class="fu">make_datetime_100</span>(year, month, day, dep_time),</span>
<span id="cb31-5"><a href=""></a>    <span class="at">arr_time =</span> <span class="fu">make_datetime_100</span>(year, month, day, arr_time),</span>
<span id="cb31-6"><a href=""></a>    <span class="at">sched_dep_time =</span> <span class="fu">make_datetime_100</span>(year, month, day, sched_dep_time),</span>
<span id="cb31-7"><a href=""></a>    <span class="at">sched_arr_time =</span> <span class="fu">make_datetime_100</span>(year, month, day, sched_arr_time)</span>
<span id="cb31-8"><a href=""></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb31-9"><a href=""></a>  <span class="fu">select</span>(origin, dest, <span class="fu">ends_with</span>(<span class="st">"delay"</span>), <span class="fu">ends_with</span>(<span class="st">"time"</span>))</span>
<span id="cb31-10"><a href=""></a>flights_dt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 328,063 × 9
   origin dest  dep_delay arr_delay dep_time            sched_dep_time     
   &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dttm&gt;              &lt;dttm&gt;             
 1 EWR    IAH           2        11 2013-01-01 05:17:00 2013-01-01 05:15:00
 2 LGA    IAH           4        20 2013-01-01 05:33:00 2013-01-01 05:29:00
 3 JFK    MIA           2        33 2013-01-01 05:42:00 2013-01-01 05:40:00
 4 JFK    BQN          -1       -18 2013-01-01 05:44:00 2013-01-01 05:45:00
 5 LGA    ATL          -6       -25 2013-01-01 05:54:00 2013-01-01 06:00:00
 6 EWR    ORD          -4        12 2013-01-01 05:54:00 2013-01-01 05:58:00
 7 EWR    FLL          -5        19 2013-01-01 05:55:00 2013-01-01 06:00:00
 8 LGA    IAD          -3       -14 2013-01-01 05:57:00 2013-01-01 06:00:00
 9 JFK    MCO          -3        -8 2013-01-01 05:57:00 2013-01-01 06:00:00
10 LGA    ORD          -2         8 2013-01-01 05:58:00 2013-01-01 06:00:00
# ℹ 328,053 more rows
# ℹ 3 more variables: arr_time &lt;dttm&gt;, sched_arr_time &lt;dttm&gt;, air_time &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="updated-flights-df-with-times-for-arrivalsdepartures" class="slide level2">
<h2>Updated flights df with times for arrivals/departures</h2>
<ul>
<li>We’ll now use these date-time values</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href=""></a>flights_dt <span class="sc">|&gt;</span></span>
<span id="cb33-2"><a href=""></a>  <span class="fu">filter</span>(dep_time <span class="sc">&lt;</span> <span class="fu">ymd</span>(<span class="dv">20130102</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 837 × 9
   origin dest  dep_delay arr_delay dep_time            sched_dep_time     
   &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dttm&gt;              &lt;dttm&gt;             
 1 EWR    IAH           2        11 2013-01-01 05:17:00 2013-01-01 05:15:00
 2 LGA    IAH           4        20 2013-01-01 05:33:00 2013-01-01 05:29:00
 3 JFK    MIA           2        33 2013-01-01 05:42:00 2013-01-01 05:40:00
 4 JFK    BQN          -1       -18 2013-01-01 05:44:00 2013-01-01 05:45:00
 5 LGA    ATL          -6       -25 2013-01-01 05:54:00 2013-01-01 06:00:00
 6 EWR    ORD          -4        12 2013-01-01 05:54:00 2013-01-01 05:58:00
 7 EWR    FLL          -5        19 2013-01-01 05:55:00 2013-01-01 06:00:00
 8 LGA    IAD          -3       -14 2013-01-01 05:57:00 2013-01-01 06:00:00
 9 JFK    MCO          -3        -8 2013-01-01 05:57:00 2013-01-01 06:00:00
10 LGA    ORD          -2         8 2013-01-01 05:58:00 2013-01-01 06:00:00
# ℹ 827 more rows
# ℹ 3 more variables: arr_time &lt;dttm&gt;, sched_arr_time &lt;dttm&gt;, air_time &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="date-time-components-accessor-functions" class="slide level2">
<h2>Date-time components: accessor functions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2026-07-08 12:34:56"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:17%;">
<p><code>year()</code>, <code>month()</code>, <code>day()</code>, <code>hour()</code>, <code>minute()</code>, <code>second()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href=""></a><span class="fu">year</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2026</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href=""></a><span class="fu">month</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href=""></a><span class="fu">mday</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:35%;">
<p><code>wday()</code> (day of the week), <code>mday()</code> (day of the month), <code>yday()</code> (day of the year),</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href=""></a><span class="fu">wday</span>(x) <span class="co"># 2026-07-08 is Weds. (Sun.=1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href=""></a><span class="fu">yday</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 189</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:48%;">
<p><code>month()</code> and <code>wday()</code> can have <code>label=TRUE</code>, returns abbreviated name of month/day</p>
<ul>
<li>Set <code>abbr=FALSE</code> to get full name</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href=""></a><span class="fu">month</span>(x, <span class="at">label=</span><span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Jul
12 Levels: Jan &lt; Feb &lt; Mar &lt; Apr &lt; May &lt; Jun &lt; Jul &lt; Aug &lt; Sep &lt; ... &lt; Dec</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href=""></a><span class="fu">wday</span>(x, <span class="at">label=</span><span class="cn">TRUE</span>, <span class="at">abbr=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Wednesday
7 Levels: Sunday &lt; Monday &lt; Tuesday &lt; Wednesday &lt; Thursday &lt; ... &lt; Saturday</code></pre>
</div>
</div>
</div></div>
</section>
<section id="date-time-components-example" class="slide level2">
<h2>Date-time components: example</h2>
<p>You can do things like calculate the minute with the highest departure delays:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href=""></a>flights_dt <span class="sc">|&gt;</span></span>
<span id="cb50-2"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">minute =</span> <span class="fu">minute</span>(dep_time)) <span class="sc">|&gt;</span></span>
<span id="cb50-3"><a href=""></a>  <span class="fu">group_by</span>(minute) <span class="sc">|&gt;</span></span>
<span id="cb50-4"><a href=""></a>  <span class="fu">summarize</span>(<span class="at">avg_delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb50-5"><a href=""></a>  <span class="fu">arrange</span>(<span class="at">by =</span> <span class="fu">desc</span>(avg_delay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 60 × 2
   minute avg_delay
    &lt;int&gt;     &lt;dbl&gt;
 1     17      18.6
 2     32      17.8
 3     34      17.8
 4     33      17.7
 5     37      17.5
 6     15      17.2
 7     13      17.1
 8     36      17.1
 9     16      17.1
10     18      17.0
# ℹ 50 more rows</code></pre>
</div>
</div>
</section>
<section id="rounding" class="slide level2">
<h2>Rounding</h2>
<div class="columns">
<div class="column" style="width:37%;">
<p>Analogues of standard rounding functions for dates:</p>
<ul>
<li><code>floor_date()</code></li>
<li><code>ceiling_date()</code></li>
<li><code>round_date()</code></li>
</ul>
<p>Arguments:</p>
<ul>
<li>vector of dates to adjust,</li>
<li>name of unit (week, day, etc)</li>
</ul>
</div><div class="column" style="width:63%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href=""></a>flights_dt <span class="sc">|&gt;</span></span>
<span id="cb52-2"><a href=""></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">9</span>) <span class="sc">|&gt;</span>  <span class="co"># selects 9 rows at random</span></span>
<span id="cb52-3"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">floor_date</span>(dep_time, <span class="st">"month"</span>), </span>
<span id="cb52-4"><a href=""></a>         <span class="at">.keep =</span> <span class="st">"used"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 2
  dep_time            year               
  &lt;dttm&gt;              &lt;dttm&gt;             
1 2013-05-28 14:40:00 2013-05-01 00:00:00
2 2013-11-07 10:37:00 2013-11-01 00:00:00
3 2013-09-02 19:30:00 2013-09-01 00:00:00
4 2013-07-09 23:49:00 2013-07-01 00:00:00
5 2013-03-22 15:27:00 2013-03-01 00:00:00
6 2013-04-17 07:03:00 2013-04-01 00:00:00
7 2013-09-25 11:52:00 2013-09-01 00:00:00
8 2013-11-11 20:25:00 2013-11-01 00:00:00
9 2013-04-18 06:35:00 2013-04-01 00:00:00</code></pre>
</div>
</div>
</div></div>
</section>
<section id="examples" class="slide level2">
<h2>Examples</h2>
<p>Compute the average delay time of flights that depart at times in two groups:</p>
<ul>
<li>departure time is (between minutes 20-30 and 50-60) vs.&nbsp;(the other times)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href=""></a>flights_dt <span class="sc">|&gt;</span></span>
<span id="cb54-2"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">dep_minute =</span> <span class="fu">minute</span>(dep_time),</span>
<span id="cb54-3"><a href=""></a>         <span class="at">mins_2030 =</span> dep_minute <span class="sc">&gt;=</span> <span class="dv">20</span> <span class="sc">&amp;</span> dep_minute <span class="sc">&lt;=</span> <span class="dv">30</span>,</span>
<span id="cb54-4"><a href=""></a>         <span class="at">mins_5060 =</span> dep_minute <span class="sc">&gt;=</span> <span class="dv">50</span> <span class="sc">&amp;</span> dep_minute <span class="sc">&lt;=</span> <span class="dv">59</span>,</span>
<span id="cb54-5"><a href=""></a>         <span class="at">mins_2030_or_5060 =</span> mins_2030 <span class="sc">|</span> mins_5060) <span class="sc">|&gt;</span></span>
<span id="cb54-6"><a href=""></a>  <span class="fu">group_by</span>(mins_2030_or_5060) <span class="sc">|&gt;</span></span>
<span id="cb54-7"><a href=""></a>  <span class="fu">summarize</span>(<span class="at">avg_dep_delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb54-8"><a href=""></a>            <span class="at">n =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  mins_2030_or_5060 avg_dep_delay      n
  &lt;lgl&gt;                     &lt;dbl&gt;  &lt;int&gt;
1 FALSE                     15.5  181621
2 TRUE                       8.90 146442</code></pre>
</div>
</div>
</section></section>
<section>
<section id="time-spans" class="title-slide slide level1 center">
<h1>Time spans</h1>

</section>
<section id="date-time-arithmetic" class="slide level2">
<h2>Date-time arithmetic</h2>
<p>Subtracting two dates returns a “difftime” object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href=""></a><span class="co"># How old is Hadley?</span></span>
<span id="cb56-2"><a href=""></a>h_age <span class="ot">&lt;-</span> <span class="fu">today</span>() <span class="sc">-</span> <span class="fu">ymd</span>(<span class="st">"1979-10-14"</span>)</span>
<span id="cb56-3"><a href=""></a>h_age</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 16616 days</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href=""></a><span class="fu">str</span>(h_age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 'difftime' num 16616
 - attr(*, "units")= chr "days"</code></pre>
</div>
</div>
<ul>
<li>Exact unit of difftime can vary from seconds, minutes, hours, days, or weeks.</li>
<li><code>as.duration()</code> always uses seconds:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href=""></a><span class="fu">as.duration</span>(h_age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1435622400s (~45.49 years)"</code></pre>
</div>
</div>
<p>Can think of difference between two times as a <strong>time span</strong></p>
</section>
<section id="time-spans-1" class="slide level2">
<h2>Time spans</h2>
<div class="columns">
<div class="column" style="width:33%;">
<p>Three important classes representing time spans:</p>
<ol type="1">
<li><strong>Durations</strong>: exact time, measured in seconds</li>
<li><strong>Periods</strong>: human units, like weeks/months</li>
<li><strong>Intervals</strong>: represent starting/end point</li>
</ol>
</div><div class="column" style="width:67%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href=""></a><span class="fu">ddays</span>(<span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">class</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Duration"
attr(,"package")
[1] "lubridate"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href=""></a><span class="fu">days</span>(<span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">class</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Period"
attr(,"package")
[1] "lubridate"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href=""></a>(<span class="fu">ymd</span>(<span class="st">"2023-01-01"</span>) <span class="sc">%--%</span> <span class="fu">ymd</span>(<span class="st">"2024-01-01"</span>)) <span class="sc">|&gt;</span> <span class="fu">class</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Interval"
attr(,"package")
[1] "lubridate"</code></pre>
</div>
</div>
</div></div>
</section>
<section id="durations-constructing-durations" class="slide level2">
<h2>Durations: constructing durations</h2>
<div class="columns">
<div class="column" style="width:48%;">
<p><strong>Durations</strong> measure exact time span (in seconds)</p>
<ul>
<li>Useful constructors: <code>d{units}</code>, <code>{units}</code> is <code>seconds</code>, <code>days</code>, etc</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href=""></a><span class="fu">dseconds</span>(<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "15s"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href=""></a><span class="fu">dminutes</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "600s (~10 minutes)"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href=""></a><span class="fu">dhours</span>(<span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">24</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "43200s (~12 hours)" "86400s (~1 days)"  </code></pre>
</div>
</div>
<ul>
<li>Cannot convert month to Duration: not well-defined</li>
</ul>
</div><div class="column fragment" style="width:52%;">
<p>Arithmetic</p>
<ul>
<li>Can add and multiply Durations:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href=""></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">dyears</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "63115200s (~2 years)"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href=""></a><span class="fu">dyears</span>(<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">dweeks</span>(<span class="dv">12</span>) <span class="sc">+</span> <span class="fu">dhours</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "38833200s (~1.23 years)"</code></pre>
</div>
</div>
<ul>
<li>Can subtract Durations to / from days</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href=""></a><span class="fu">today</span>() <span class="sc">+</span> <span class="fu">ddays</span>(<span class="dv">1</span>) <span class="co"># returns Date</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-04-12"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href=""></a><span class="fu">today</span>() <span class="sc">-</span> <span class="fu">dyears</span>(<span class="dv">1</span>) <span class="co"># returns date-time</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2024-04-10 18:00:00 UTC"</code></pre>
</div>
</div>
</div></div>
</section>
<section id="durations-computations-and-weird-results" class="slide level2">
<h2>Durations: computations and weird results</h2>
<ul>
<li>Because durations represent an exact number of seconds, things can be odd when looking at time zones</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href=""></a>one_am <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2026-03-08 01:00:00"</span>, <span class="at">tz =</span> <span class="st">"America/New_York"</span>)</span>
<span id="cb82-2"><a href=""></a>one_am</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2026-03-08 01:00:00 EST"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href=""></a>one_am <span class="sc">+</span> <span class="fu">ddays</span>(<span class="dv">1</span>)  <span class="co"># the day advances, but the hour also advances</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2026-03-09 02:00:00 EDT"</code></pre>
</div>
</div>
<ul>
<li>If we add a full day of seconds, would need to account for hour time change from EST to EDT.</li>
<li>lubridate package provides <strong>periods</strong> to address this</li>
</ul>
</section>
<section id="periods" class="slide level2">
<h2>Periods</h2>
<p>Periods are time spans but don’t have fixed length in seconds</p>
<div class="columns">
<div class="column" style="width:42%;">
<ul>
<li>Work like “human” times, i.e.&nbsp;days/months</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href=""></a>one_am</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2026-03-08 01:00:00 EST"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href=""></a><span class="co"># days() returns a Period object</span></span>
<span id="cb88-2"><a href=""></a>one_am <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">1</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2026-03-09 01:00:00 EDT"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href=""></a><span class="co"># ddays() returns a Duration object</span></span>
<span id="cb90-2"><a href=""></a>one_am <span class="sc">+</span> <span class="fu">ddays</span>(<span class="dv">1</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2026-03-09 02:00:00 EDT"</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:58%;">
<ul>
<li>Useful constructors and behavior under <code>+</code>/<code>*</code>:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href=""></a><span class="fu">hours</span>(<span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">24</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "12H 0M 0S" "24H 0M 0S"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href=""></a><span class="fu">days</span>(<span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "7d 0H 0M 0S"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href=""></a><span class="fu">months</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2m 0d 0H 0M 0S" "3m 0d 0H 0M 0S"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href=""></a><span class="fu">months</span>(<span class="dv">6</span>) <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "6m 2d 0H 0M 0S"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href=""></a><span class="dv">10</span> <span class="sc">*</span> (<span class="fu">months</span>(<span class="dv">6</span>) <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "60m 20d 0H 0M 0S"</code></pre>
</div>
</div>
</div></div>
</section>
<section id="periods-vs-durations" class="slide level2">
<h2>Periods: vs Durations</h2>
<p>Adding periods can be a bit more in line with expectations</p>
<ul>
<li>Example: a leap year</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href=""></a><span class="fu">ymd</span>(<span class="st">"2024-01-01"</span>) <span class="sc">+</span> <span class="fu">dyears</span>(<span class="dv">1</span>)  <span class="co"># date + Duration</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2024-12-31 06:00:00 UTC"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href=""></a><span class="fu">ymd</span>(<span class="st">"2024-01-01"</span>) <span class="sc">+</span> <span class="fu">years</span>(<span class="dv">1</span>)  <span class="co"># date + Period</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-01-01"</code></pre>
</div>
</div>
<ul>
<li>Example: Daylight saving time</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href=""></a>one_am <span class="sc">+</span> <span class="fu">ddays</span>(<span class="dv">1</span>)  <span class="co"># date-time + Duration</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2026-03-09 02:00:00 EDT"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href=""></a>one_am <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">1</span>)  <span class="co"># date-time + Period</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2026-03-09 01:00:00 EDT"</code></pre>
</div>
</div>
</section>
<section id="fixing-a-bug-in-flights_dt" class="slide level2">
<h2>Fixing a bug in <code>flights_dt</code></h2>
<!-- * We used same date information for arrival and departure times, but the flights really arrived on the following day. -->
<p>Some flights arrived before they departed?!</p>
<div class="cell" data-output.lines="6">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href=""></a>flights_dt <span class="sc">|&gt;</span> <span class="fu">filter</span>(arr_time <span class="sc">&lt;</span> dep_time) <span class="sc">|&gt;</span> <span class="fu">select</span>(origin, dest, arr_time, dep_time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,633 × 4
   origin dest  arr_time            dep_time           
   &lt;chr&gt;  &lt;chr&gt; &lt;dttm&gt;              &lt;dttm&gt;             
 1 EWR    BQN   2013-01-01 00:03:00 2013-01-01 19:29:00
 2 JFK    DFW   2013-01-01 00:29:00 2013-01-01 19:39:00
 3 EWR    TPA   2013-01-01 00:08:00 2013-01-01 20:58:00
...</code></pre>
</div>
</div>
<p>These are overnight flights: flights arrived on the following day.</p>
<div class="cell" data-output.lines="6">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href=""></a>flights <span class="sc">|&gt;</span> <span class="fu">filter</span>(arr_time <span class="sc">&lt;</span> dep_time) <span class="sc">|&gt;</span> <span class="fu">select</span>(origin, dest, arr_time, dep_time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,633 × 4
   origin dest  arr_time dep_time
   &lt;chr&gt;  &lt;chr&gt;    &lt;int&gt;    &lt;int&gt;
 1 EWR    BQN          3     1929
 2 JFK    DFW         29     1939
 3 EWR    TPA          8     2058
...</code></pre>
</div>
</div>
</section>
<section id="fixing-a-bug-in-flights_dt-1" class="slide level2">
<h2>Fixing a bug in <code>flights_dt</code></h2>
<p>We can fix this by adding a day to the arrival time of each overnight flight.</p>
<ul>
<li><code>days(TRUE)</code> gets coerced to <code>days(1)</code><br>
</li>
<li><code>days(FALSE)</code> gets coerced to <code>days(0)</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href=""></a>flights_dt_2 <span class="ot">&lt;-</span> flights_dt <span class="sc">|&gt;</span> </span>
<span id="cb114-2"><a href=""></a>  <span class="fu">mutate</span>(</span>
<span id="cb114-3"><a href=""></a>    <span class="at">overnight =</span> arr_time <span class="sc">&lt;</span> dep_time,  <span class="co"># returns T/F</span></span>
<span id="cb114-4"><a href=""></a>    <span class="at">arr_time =</span> arr_time <span class="sc">+</span> <span class="fu">days</span>(overnight),  <span class="co"># coercion</span></span>
<span id="cb114-5"><a href=""></a>    <span class="at">sched_arr_time =</span> sched_arr_time <span class="sc">+</span> <span class="fu">days</span>(overnight)</span>
<span id="cb114-6"><a href=""></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now <code>flights_dt_2</code> has no flight that appears to arrive before it departed:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href=""></a>flights_dt_2 <span class="sc">|&gt;</span> <span class="fu">filter</span>(arr_time <span class="sc">&lt;</span> dep_time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 10
# ℹ 10 variables: origin &lt;chr&gt;, dest &lt;chr&gt;, dep_delay &lt;dbl&gt;, arr_delay &lt;dbl&gt;,
#   dep_time &lt;dttm&gt;, sched_dep_time &lt;dttm&gt;, arr_time &lt;dttm&gt;,
#   sched_arr_time &lt;dttm&gt;, air_time &lt;dbl&gt;, overnight &lt;lgl&gt;</code></pre>
</div>
</div>
<!-- ## Intervals -->
<!-- ::::: columns -->
<!-- ::: {.column width="40%"} -->
<!-- * `dyears(1) / ddays(365)` does not return 1, since `dyears()` is defined as the number of seconds per average year: 365.25 days. -->
<!-- * `years(1) / days(1)` does not return 365, since in leap years this isn't true. -->
<!-- * **Intervals** allow for defining specific intervals of time, using pair of starting/end date times. -->
<!-- * Format: `start %--% end`: -->
<!-- ::: -->
<!-- ::: {.column width="60%"} -->
<!-- ```{r} -->
<!-- (y2023 <- ymd("2023-01-01") %--% ymd("2024-01-01")) -->
<!-- (y2024 <- ymd("2024-01-01") %--% ymd("2025-01-01")) -->
<!-- ``` -->
<!-- * Can divide by `days()` to find out how many days/year: -->
<!-- ```{r} -->
<!-- y2023 / days(1) -->
<!-- y2024 / days(1) -->
<!-- ``` -->
<!-- ::: -->
<!-- ::::: -->
</section>
<section id="intervals" class="slide level2">
<h2>Intervals</h2>
<p>Motivating calculations</p>
<ul>
<li><code>dyears(1) / ddays(365)</code> does not return 1, since <code>dyears()</code> is defined as the number of seconds per average year: 365.25 days.</li>
<li><code>years(1) / days(1)</code> does not return 365, since in leap years this isn’t true.</li>
</ul>
<p><strong>Intervals</strong> allow for defining a time interval between two specific date-times.</p>
<div class="columns">
<div class="column fragment" style="width:70%;">
<ul>
<li>Format: <code>start %--% end</code>:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href=""></a>(y2023 <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"2023-01-01"</span>) <span class="sc">%--%</span> <span class="fu">ymd</span>(<span class="st">"2024-01-01"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2023-01-01 UTC--2024-01-01 UTC</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href=""></a>(y2024 <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"2024-01-01"</span>) <span class="sc">%--%</span> <span class="fu">ymd</span>(<span class="st">"2025-01-01"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2024-01-01 UTC--2025-01-01 UTC</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:30%;">
<p>Can divide by <code>days()</code> to find out how many days in specific year:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href=""></a>y2023 <span class="sc">/</span> <span class="fu">days</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 365</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href=""></a>y2024 <span class="sc">/</span> <span class="fu">days</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 366</code></pre>
</div>
</div>
</div></div>
</section></section>
<section>
<section id="putting-it-all-together" class="title-slide slide level1 center">
<h1>Putting it all together</h1>

</section>
<section id="example-extracting-dates-and-computing-durations" class="slide level2">
<h2>Example: extracting dates and computing durations</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href=""></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  name  entry                                                  
  &lt;chr&gt; &lt;chr&gt;                                                  
1 Ant   First arrival: Jan 2, 2005; Second arrival: Jan 6, 2023
2 Bug   First time: Jan 5, 1997; Second time: Jan 8, 2015      
3 Cat   First visit: Jan 4, 1990; Second visit: Jan 9, 2008    </code></pre>
</div>
</div>
<p>Task: using <code>df</code>, return a tibble that says how many days elapsed between the first and second visit.</p>
<p>Complex task! We need to:</p>
<ol type="1">
<li>Parse the “entry” column to extract the dates</li>
<li>Turn them into proper date-times</li>
<li>Compute <span class="math inline">\(\#\)</span> of days between visits (leap years happen at different times!)</li>
</ol>
<p>Let’s start by parsing “entry” and creating two columns for different dates</p>
</section>
<section id="example-extracting-dates-and-computing-durations-1" class="slide level2">
<h2>Example: extracting dates and computing durations</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb127" data-code-line-numbers="2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href=""></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  name  entry                                                  
  &lt;chr&gt; &lt;chr&gt;                                                  
1 Ant   First arrival: Jan 2, 2005; Second arrival: Jan 6, 2023
2 Bug   First time: Jan 5, 1997; Second time: Jan 8, 2015      
3 Cat   First visit: Jan 4, 1990; Second visit: Jan 9, 2008    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb129" data-code-line-numbers="2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href=""></a>df <span class="sc">|&gt;</span>  <span class="co"># step 1: separate two strings</span></span>
<span id="cb129-2"><a href=""></a>  <span class="fu">separate_wider_delim</span>(entry, <span class="at">delim=</span><span class="st">"; "</span>, <span class="at">names=</span><span class="fu">c</span>(<span class="st">"d1"</span>, <span class="st">"d2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  name  d1                         d2                         
  &lt;chr&gt; &lt;chr&gt;                      &lt;chr&gt;                      
1 Ant   First arrival: Jan 2, 2005 Second arrival: Jan 6, 2023
2 Bug   First time: Jan 5, 1997    Second time: Jan 8, 2015   
3 Cat   First visit: Jan 4, 1990   Second visit: Jan 9, 2008  </code></pre>
</div>
</div>
</section>
<section id="example-extracting-dates-and-computing-durations-2" class="slide level2">
<h2>Example: extracting dates and computing durations</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb131" data-code-line-numbers="3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href=""></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  name  entry                                                  
  &lt;chr&gt; &lt;chr&gt;                                                  
1 Ant   First arrival: Jan 2, 2005; Second arrival: Jan 6, 2023
2 Bug   First time: Jan 5, 1997; Second time: Jan 8, 2015      
3 Cat   First visit: Jan 4, 1990; Second visit: Jan 9, 2008    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb133" data-code-line-numbers="3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href=""></a>df <span class="sc">|&gt;</span>  <span class="co"># step 2: get date from "d1"</span></span>
<span id="cb133-2"><a href=""></a>  <span class="fu">separate_wider_delim</span>(entry, <span class="at">delim=</span><span class="st">"; "</span>, <span class="at">names=</span><span class="fu">c</span>(<span class="st">"d1"</span>, <span class="st">"d2"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb133-3"><a href=""></a>  <span class="fu">separate_wider_delim</span>(d1, <span class="at">delim=</span><span class="st">": "</span>, <span class="at">names=</span><span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">"date1"</span>))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  name  date1       d2                         
  &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;                      
1 Ant   Jan 2, 2005 Second arrival: Jan 6, 2023
2 Bug   Jan 5, 1997 Second time: Jan 8, 2015   
3 Cat   Jan 4, 1990 Second visit: Jan 9, 2008  </code></pre>
</div>
</div>
</section>
<section id="example-extracting-dates-and-computing-durations-3" class="slide level2">
<h2>Example: extracting dates and computing durations</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb135" data-code-line-numbers="4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href=""></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  name  entry                                                  
  &lt;chr&gt; &lt;chr&gt;                                                  
1 Ant   First arrival: Jan 2, 2005; Second arrival: Jan 6, 2023
2 Bug   First time: Jan 5, 1997; Second time: Jan 8, 2015      
3 Cat   First visit: Jan 4, 1990; Second visit: Jan 9, 2008    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb137" data-code-line-numbers="4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href=""></a>df <span class="sc">|&gt;</span>  <span class="co"># step 3: get date from "d2"</span></span>
<span id="cb137-2"><a href=""></a>  <span class="fu">separate_wider_delim</span>(entry, <span class="at">delim=</span><span class="st">"; "</span>, <span class="at">names=</span><span class="fu">c</span>(<span class="st">"d1"</span>, <span class="st">"d2"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb137-3"><a href=""></a>  <span class="fu">separate_wider_delim</span>(d1, <span class="at">delim=</span><span class="st">": "</span>, <span class="at">names=</span><span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">"date1"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb137-4"><a href=""></a>  <span class="fu">separate_wider_delim</span>(d2, <span class="at">delim=</span><span class="st">": "</span>, <span class="at">names=</span><span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">"date2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  name  date1       date2      
  &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;      
1 Ant   Jan 2, 2005 Jan 6, 2023
2 Bug   Jan 5, 1997 Jan 8, 2015
3 Cat   Jan 4, 1990 Jan 9, 2008</code></pre>
</div>
</div>
</section>
<section id="example-extracting-dates-and-computing-durations-4" class="slide level2">
<h2>Example: extracting dates and computing durations</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb139" data-code-line-numbers="5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href=""></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  name  entry                                                  
  &lt;chr&gt; &lt;chr&gt;                                                  
1 Ant   First arrival: Jan 2, 2005; Second arrival: Jan 6, 2023
2 Bug   First time: Jan 5, 1997; Second time: Jan 8, 2015      
3 Cat   First visit: Jan 4, 1990; Second visit: Jan 9, 2008    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb141" data-code-line-numbers="5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href=""></a>df <span class="sc">|&gt;</span>  <span class="co"># step 4: convert "date1" and "date2" into Dates</span></span>
<span id="cb141-2"><a href=""></a>  <span class="fu">separate_wider_delim</span>(entry, <span class="at">delim=</span><span class="st">"; "</span>, <span class="at">names=</span><span class="fu">c</span>(<span class="st">"d1"</span>, <span class="st">"d2"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb141-3"><a href=""></a>  <span class="fu">separate_wider_delim</span>(d1, <span class="at">delim=</span><span class="st">": "</span>, <span class="at">names=</span><span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">"date1"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb141-4"><a href=""></a>  <span class="fu">separate_wider_delim</span>(d2, <span class="at">delim=</span><span class="st">": "</span>, <span class="at">names=</span><span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">"date2"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb141-5"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">date1 =</span> <span class="fu">mdy</span>(date1), <span class="at">date2 =</span> <span class="fu">mdy</span>(date2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  name  date1      date2     
  &lt;chr&gt; &lt;date&gt;     &lt;date&gt;    
1 Ant   2005-01-02 2023-01-06
2 Bug   1997-01-05 2015-01-08
3 Cat   1990-01-04 2008-01-09</code></pre>
</div>
</div>
</section>
<section id="example-extracting-dates-and-computing-durations-5" class="slide level2">
<h2>Example: extracting dates and computing durations</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb143" data-code-line-numbers="6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href=""></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  name  entry                                                  
  &lt;chr&gt; &lt;chr&gt;                                                  
1 Ant   First arrival: Jan 2, 2005; Second arrival: Jan 6, 2023
2 Bug   First time: Jan 5, 1997; Second time: Jan 8, 2015      
3 Cat   First visit: Jan 4, 1990; Second visit: Jan 9, 2008    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb145" data-code-line-numbers="6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href=""></a>df <span class="sc">|&gt;</span>  <span class="co"># step 5: compute number of days between visits</span></span>
<span id="cb145-2"><a href=""></a>  <span class="fu">separate_wider_delim</span>(entry, <span class="at">delim=</span><span class="st">"; "</span>, <span class="at">names=</span><span class="fu">c</span>(<span class="st">"d1"</span>, <span class="st">"d2"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb145-3"><a href=""></a>  <span class="fu">separate_wider_delim</span>(d1, <span class="at">delim=</span><span class="st">": "</span>, <span class="at">names=</span><span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">"date1"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb145-4"><a href=""></a>  <span class="fu">separate_wider_delim</span>(d2, <span class="at">delim=</span><span class="st">": "</span>, <span class="at">names=</span><span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">"date2"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb145-5"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">date1 =</span> <span class="fu">mdy</span>(date1), <span class="at">date2 =</span> <span class="fu">mdy</span>(date2), </span>
<span id="cb145-6"><a href=""></a>         <span class="at">days_elapsed =</span> <span class="fu">days</span>(date2<span class="sc">-</span>date1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  name  date1      date2      days_elapsed  
  &lt;chr&gt; &lt;date&gt;     &lt;date&gt;     &lt;Period&gt;      
1 Ant   2005-01-02 2023-01-06 6578d 0H 0M 0S
2 Bug   1997-01-05 2015-01-08 6577d 0H 0M 0S
3 Cat   1990-01-04 2008-01-09 6579d 0H 0M 0S</code></pre>
</div>
</div>
<!-- ## Example: extracting dates and computing durations -->
<!-- ```{r echo=FALSE} -->
<!--  df <- tribble( -->
<!--     ~name, ~entry, -->
<!--     "Ant", "First arrival: Jan 2, 2005; Second arrival: Jan 6, 2023", -->
<!--     "Bug", "First time: Jan 5, 1997; Second time: Jan 8, 2015", -->
<!--     "Cat", "First visit: Jan 4, 1990; Second visit: Jan 9, 2008", -->
<!--   ) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- df -->
<!-- ``` -->
<!-- Task: using `df`, return a tibble that says how many days elapsed between the first and second visit, ordered by the most number of days. Thus we need to: -->
<!-- 1. Parse the "entry" column to extract the dates -->
<!-- 2. Turn them into proper date-times -->
<!-- 3. Compute $\#$ of days between visits (leap years happen at different times!) -->
<!-- 4. Order by number of days -->
<!-- Let's start by parsing "entry" and creating two columns for different dates -->
<!-- ## Example: extracting dates and computing durations -->
<!-- ```{r} -->
<!-- df  # `entry` elements look like "something: something; something: something" -->
<!-- ``` -->
<!-- <!-- * `entry` elements look like:  -->
<p>–&gt; <!-- <!--   * "First arrival: January 2, 2005; Second arrival: January 9, 2023" --> –&gt; <!-- ```{r} --> <!-- df1 <- df |> mutate( --> <!--   date1 = str_replace(entry, pattern = "(.*): (.*); (.*): (.*)", replacement = "\\2"), --> <!--   date2 = str_replace(entry, pattern = "(.*): (.*); (.*): (.*)", replacement = "\\4") --> <!--   ) --> <!-- df1 --> <!-- ``` --></p>
<!-- ## Example: extracting dates and computing durations -->
<!-- ```{r} -->
<!-- df  # `entry` elements look like "something: something; something: something" -->
<!-- ``` -->
<!-- <!-- * `entry` elements look like:  -->
<p>–&gt; <!-- <!--   * "First arrival: January 2, 2005; Second arrival: January 9, 2023" --> –&gt; <!-- ```{r} --> <!-- df2 <- df1 |> mutate( --> <!--   date1 = mdy(date1), --> <!--   date2 = mdy(date2) --> <!--   ) --> <!-- df2 --> <!-- ``` --></p>
<!-- ## Example: extracting dates and computing durations -->
<!-- * Now we want to compute number of days between `date1` and `date2`: -->
<!-- ```{r} -->
<!-- df2 |> mutate(days_elapsed = days(date2 - date1)) -->
<!-- ``` -->
<!-- ## Example: extracting dates and computing durations -->
<!-- * Just need to order by maximum number of days now  -->
<!-- ```{r} -->
<!-- df |> mutate( -->
<!--     date1 = mdy(str_replace(entry, "(.*): (.*); (.*): (.*)", "\\2")), -->
<!--     date2 = mdy(str_replace(entry, "(.*): (.*); (.*): (.*)", "\\4")), -->
<!--     days_elapsed = days(date2-date1) -->
<!--   ) |> arrange(by = desc(days_elapsed)) -->
<!-- ``` -->
<!-- * We could also have done `separate_wider_regex()` to parse the string initially. How would we do that? -->
<!-- ## Examples -->
<!-- ::::: columns -->
<!-- ::: {.column width="40%"} -->
<!-- ```{r} -->
<!-- df2 <- df |> separate_wider_regex( -->
<!--   entry, -->
<!--   patterns = c( -->
<!--     ".*", -->
<!--     ": ", -->
<!--     date1 = ".*", -->
<!--     ";", -->
<!--     ".*", -->
<!--     ": ", -->
<!--     date2 = ".*" -->
<!--   ) ) |> -->
<!--   mutate(date1 = mdy(date1), date2 = mdy(date2)) -->
<!-- ``` -->
<!-- * Original df: -->
<!-- ```{r} -->
<!-- df -->
<!-- ``` -->
<!-- ::: -->
<!-- ::: {.column width="60%"} -->
<!-- ```{r} -->
<!-- df2 -->
<!-- ``` -->
<!-- ::: -->
<!-- ::::: -->
<!-- ## Example - string formatting errors for dates -->
<!-- * Let's suppose we are given a string with a bunch of supposed dates -->
<!-- ```{r} -->
<!-- ds <- c("2022-01-08", "202-01-09", "2022/01/10") -->
<!-- ``` -->
<!-- * And suppose we want to return a new datetime vector satisfying the following: -->
<!--   * if the date is in the correct format, it is the original datetime -->
<!--   * otherwise, return the datetime of january 1, year 1.  -->
<!-- * We need to flag which elements of `ds` have the format of either YYYY-MM-DD or YYYY/MM/DD, i.e. return a vector with booleans saying whether that element has the correct format. -->
<!-- * We'll use regular expressions -->
<!-- ```{r} -->
<!-- pattern_regex <- "^\\d{4}[-/]\\d{2}[-/]\\d{2}$" -->
<!-- str_detect(ds, pattern_regex) -->
<!-- ``` -->
<!-- ## Example - string formatting errors for dates -->
<!-- ```{r} -->
<!-- ds -->
<!-- str_detect(ds, "^\\d{4}[-/]\\d{2}[-/]\\d{2}$") -->
<!-- ``` -->
<!-- * Now we can use a `case_when` to make it year 1 if not correct format: -->
<!-- ```{r} -->
<!-- df <- tibble(entered = ds) -->
<!-- df |> mutate(new_date = case_when( -->
<!--   str_detect(entered, "^\\d{4}[-/]\\d{2}[-/]\\d{2}$") ~ ymd(entered, quiet=TRUE), -->
<!--   TRUE ~ ymd("0001-01-01") ) -->
<!--   ) -->
<!-- ``` -->
<div class="quarto-auto-generated-content">
<div class="footer footer-default">
<p><a href="https://ahoriguchi.github.io/teaching/STA35B/website.html" class="uri">https://ahoriguchi.github.io/teaching/STA35B/website.html</a></p>
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="lec07_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="lec07_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="lec07_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="lec07_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="lec07_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="lec07_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="lec07_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="lec07_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="lec07_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="lec07_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'h.v',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>